{
  "rules": {
    ".read": false,
    ".write": false,
    "roomsByCode": {
      ".read": true,
      "$code": {
        ".write": "auth != null"
      }
    },
    "rooms": {
      "$roomId": {
        "meta": {
          ".read": "auth != null",
          ".write": "auth != null && auth.uid == data.parent().child('meta/gmUid').val()"
        },
        "members": {
          ".read": "auth != null",
          "$uid": {
            ".write": "auth != null && (auth.uid == data.parent().parent().child('meta/gmUid').val() || (auth.uid == $uid && !data.exists()))"
          }
        },
        "assignmentsByPlayer": {
          "$uid": {
            ".read": "auth != null && (auth.uid == $uid || auth.uid == data.parent().parent().child('meta/gmUid').val())",
            ".write": "auth != null && auth.uid == data.parent().parent().child('meta/gmUid').val()"
          }
        },
        "playersBySheet": {
          "$sheetId": {
            ".read": "auth != null && (auth.uid == data.parent().parent().child('meta/gmUid').val() || data.child(auth.uid).exists())",
            ".write": "auth != null && auth.uid == data.parent().parent().child('meta/gmUid').val()"
          }
        },
        "sheets": {
          "$sheetId": {
            ".read": "auth != null && (auth.uid == data.parent().parent().child('meta/gmUid').val() || data.parent().parent().child('playersBySheet/'+$sheetId+'/'+auth.uid).exists())",
            ".write": "auth != null && auth.uid == data.parent().parent().child('meta/gmUid').val()",
            "sharedNotes": {
              ".read": "auth != null && (auth.uid == data.parent().parent().parent().child('meta/gmUid').val() || data.parent().parent().parent().child('playersBySheet/'+$sheetId+'/'+auth.uid).exists())",
              ".write": "auth != null && (auth.uid == data.parent().parent().parent().child('meta/gmUid').val() || data.parent().parent().parent().child('playersBySheet/'+$sheetId+'/'+auth.uid).exists())"
            }
          }
        }
      }
    }
  }
}